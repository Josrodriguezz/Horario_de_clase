{% extends "base.html" %}

{% block content %}
<!-- Schedule Section -->
<div id="schedule-section" class="content-section">
    <h2 class="mb-4">Horario de Clases</h2>
    <div class="table-responsive">
        <table class="table table-bordered schedule-table">
            <thead>
                <tr>
                    <th>Lunes</th>
                    <th>Martes</th>
                    <th>Miércoles</th>
                    <th>Jueves</th>
                    <th>Viernes</th>
                    <th>Sábado</th>
                </tr>
            </thead>
            <tbody id="schedule-body">
                <!-- JavaScript will populate this -->
            </tbody>
        </table>
    </div>
</div>

<!-- Calendar Section -->
<div id="calendar-section" class="content-section" style="display: none;">
    <h2 class="mb-4">Calendario de Clases</h2>
    <div class="d-flex justify-content-between mb-4">
        <button class="btn btn-outline-primary" id="prev-month">
            <i class="fas fa-chevron-left"></i> Mes Anterior
        </button>
        <h4 id="current-month-year"></h4>
        <button class="btn btn-outline-primary" id="next-month">
            Mes Siguiente <i class="fas fa-chevron-right"></i>
        </button>
    </div>
    <div id="calendar" class="bg-white rounded shadow-sm p-4">
        <!-- Calendar will be generated by JavaScript -->
    </div>
</div>

<!-- Grades Section -->
<div id="grades-section" class="content-section" style="display: none;">
    <h2 class="mb-4">Sistema de Notas</h2>
    <div class="row">
        <div class="col-md-6">
            <div class="notes-section">
                <h4 class="mb-4">Registrar Nueva Nota</h4>
                <form id="grade-form">
                    <div class="mb-3">
                        <label for="subject" class="form-label">Materia</label>
                        <select class="form-select" id="subject" required>
                            <option value="">Seleccionar materia...</option>
                        </select>
                    </div>
                    <div class="mb-3">
                        <label for="grade" class="form-label">Nota</label>
                        <input type="number" step="0.01" min="0" max="5" class="form-control" id="grade" required>
                    </div>
                    <div class="mb-3">
                        <label for="percentage" class="form-label">Porcentaje (%)</label>
                        <input type="number" step="1" min="1" max="100" class="form-control" id="percentage" required>
                    </div>
                    <div class="mb-3">
                        <label for="description" class="form-label">Descripción</label>
                        <input type="text" class="form-control" id="description" required>
                    </div>
                    <div class="mb-3">
                        <label for="date" class="form-label">Fecha</label>
                        <input type="date" class="form-control" id="date" required>
                    </div>
                    <button type="submit" class="btn btn-primary">Guardar Nota</button>
                </form>
            </div>
        </div>
        <div class="col-md-6">
            <div class="notes-section">
                <h4 class="mb-4">Resumen de Notas</h4>
                <div id="grades-summary">
                    <!-- Grades will be loaded here -->
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Manage Schedule Section -->
<div id="manage-section" class="content-section" style="display: none;">
    <h2 class="mb-4">Gestionar Horario</h2>
    <div class="row">
        <div class="col-md-6">
            <div class="notes-section">
                <h4 class="mb-4">Agregar Nueva Clase</h4>
                <form id="schedule-form">
                    <div class="mb-3">
                        <label for="day" class="form-label">Día de la semana</label>
                        <select class="form-select" id="day" required>
                            <option value="">Seleccionar día...</option>
                            <option value="monday">Lunes</option>
                            <option value="tuesday">Martes</option>
                            <option value="wednesday">Miércoles</option>
                            <option value="thursday">Jueves</option>
                            <option value="friday">Viernes</option>
                            <option value="saturday">Sábado</option>
                        </select>
                    </div>
                    <div class="mb-3">
                        <label for="new-subject" class="form-label">Materia</label>
                        <input type="text" class="form-control" id="new-subject" required>
                    </div>
                    <div class="mb-3">
                        <label for="group" class="form-label">Grupo</label>
                        <input type="text" class="form-control" id="group">
                    </div>
                    <div class="mb-3">
                        <label for="modality" class="form-label">Modalidad</label>
                        <select class="form-select" id="modality" required>
                            <option value="Normal">Normal</option>
                            <option value="Virtual">Virtual</option>
                            <option value="Cada 15 días">Cada 15 días</option>
                        </select>
                    </div>
                    <div class="mb-3">
                        <label for="teacher" class="form-label">Docente</label>
                        <input type="text" class="form-control" id="teacher">
                    </div>
                    <div class="mb-3" id="start-date-container" style="display: none;">
                        <label for="start-date" class="form-label">Fecha de inicio (para clases cada 15 días)</label>
                        <input type="date" class="form-control" id="start-date">
                    </div>
                    <button type="submit" class="btn btn-primary">Agregar Clase</button>
                </form>
            </div>
        </div>
        <div class="col-md-6">
            <div class="notes-section">
                <h4 class="mb-4">Mis Clases</h4>
                <div id="schedule-list">
                    <!-- Schedule items will be loaded here -->
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    document.addEventListener('DOMContentLoaded', function() {
        // Set current date for grade form
        document.getElementById('date').valueAsDate = new Date();
        
        // Show/hide start date based on modality
        document.getElementById('modality').addEventListener('change', function() {
            const startDateContainer = document.getElementById('start-date-container');
            startDateContainer.style.display = this.value === 'Cada 15 días' ? 'block' : 'none';
        });
        
        // Load initial data
        loadSchedule();
        loadGrades();
        loadSubjects();
    });
</script>
{% endblock %}